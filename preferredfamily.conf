<VirtualHost 172.20.0.134:80 172.20.0.135:80>
    DocumentRoot /var/www/html/preferredfamily_com/www
    ServerName preferredfamily.demos.sabrehospitality.com
    
    RewriteEngine on

	#RewriteCond %{HTTP_HOST} !^www\.
	#RewriteCond %{HTTP_HOST} !demos.sabrehospitality.com
	#RewriteRule ^(.*)$ http://www.%{HTTP_HOST}$1 [R=301,L]\

        RewriteCond %{REQUEST_URI}	!^/family-hotel/results.php
        RewriteCond %{REQUEST_URI}	!^/family-hotel/map.php
        RewriteRule ^/family-hotel/([^/]+(/.*)?)     /templates/destination.php?uri=$1 [QSA,L]
	
	RewriteRule ^/direct/(.*) /direct/$1 [QSA,L] #allows direct http access to non language specific php files.
    RewriteRule ^/images/(.*)     /images/$1 [QSA,L] #allows direct http access to non language specific php files.
    
	RewriteRule ^/(rss/.*)/$   /$1? [NC,R=301,L,QSA]
	RewriteRule ^/(rss/.*)     /direct/rss.php?permalink=$1 [L,QSA]
	 
    RewriteRule ^/(press/.*)/$     /$1? [NC,R=301,L,QSA]
    RewriteRule ^/(press/.*)       /en/press.php?permalink=$1 [L,QSA]
    
    RewriteRule ^/(events/.*)/$     /$1? [NC,R=301,L,QSA]
    RewriteRule ^/(events/.*)       /en/events.php?permalink=$1 [L,QSA]

	RewriteRule ^/(packages/.*)/$   /$1? [NC,R=301,L,QSA]
	RewriteRule ^/(packages/.*)     /en/packages.php?permalink=$1 [L,QSA]

    RewriteRule ^/([a-z]{2}\/.*) /$1 [QSA,L] #any language subdirectory should be left alone
    RewriteRule ^/(.*\/$)    /en/$1index.php [QSA,L] #fix for links ending in /
    RewriteRule ^/(.*\.php)    /en/$1 [QSA,L]  #any php file with no language subdirectory redirects to the default language
    RewriteRule ^/(.*\.html) /en/$1 [QSA,L]  #any html file with no language subdirectory redirects to the default language
	
    ErrorLog "|/usr/sbin/rotatelogs /var/www/html/preferredfamily_com/logs/errors/%Y-%m-%d_errors.log 86400"
    CustomLog "|/usr/sbin/rotatelogs /var/www/html/preferredfamily_com/logs/%Y-%m-%d_access.log 86400" combined
    ErrorDocument 404 /404.php
    Options -Indexes

</VirtualHost>
